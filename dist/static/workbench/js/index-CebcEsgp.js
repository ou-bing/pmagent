import{ad as _t,av as mt,N as en,y as tn,a7 as nn,l as ln,a2 as Z,aT as an,aU as on,B as Ut,b as O,r as se,h as j,f as ze,g as ke,aV as Pt,t as rn,aj as kt,aW as Ot,a4 as wt,q as Qe,u as $t,n as dn,i as rt,j as Mt,aX as sn,A as z,ax as cn,aw as un,aA as fn,w as At,x as hn,aB as gn,aC as vn,aD as yn,aY as bn}from"./bootstrap-Cg7-XUCZ.js";import{d as Fe,h as g,i as He,r as A,c as D,o as mn,W as Je,B as F,w as ot,U as jt,s as it,a2 as kn}from"../jse/index-index-C-XMneWz.js";import{NCheckbox as xn}from"./index-SE0yhI4v.js";import{h as Ve,F as wn}from"./FocusDetector-DNXykDX-.js";import{V as pn}from"./VirtualList-DbRU3GWH.js";import{b as pt,c as Sn,N as St,f as Lt,a as Rn,u as Cn}from"./Selection-BX8kiJdn.js";import{u as Le}from"./use-merged-state-Bwrns1mu.js";import{B as Nn,V as Kn,e as Tn,u as Rt}from"./Follower-aU9Fs2Dd.js";import{u as Fn}from"./use-locale-Db9MCNcL.js";import"./Suffix-DGl6IH6C.js";import"./Popover-dimvNU90.js";function zt(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const Dn=Fe({name:"Switcher",render(){return g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},g("path",{d:"M12 8l10 8l-10 8z"}))}}),Nt=_t("n-tree-select");function Et({position:e,offsetLevel:l,indent:r,el:c}){const i={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")i.left=0,i.top=0,i.bottom=0,i.borderRadius="inherit",i.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const s=e==="before"?"top":"bottom";i[s]=0,i.left=`${c.offsetLeft+6-l*r}px`,i.height="2px",i.backgroundColor="var(--n-drop-mark-color)",i.transformOrigin=s,i.borderRadius="1px",i.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return g("div",{style:i})}function Pn({dropPosition:e,node:l}){return l.isLeaf===!1||l.children?!0:e!=="inside"}const Ze=_t("n-tree");function On({props:e,fNodesRef:l,mergedExpandedKeysRef:r,mergedSelectedKeysRef:c,mergedCheckedKeysRef:i,handleCheck:s,handleSelect:w,handleSwitcherClick:y}){const{value:x}=c,k=He(Nt,null),p=k?k.pendingNodeKeyRef:A(x.length?x[x.length-1]:null);function U(K){var B;if(!e.keyboard)return{enterBehavior:null};const{value:I}=p;let C=null;if(I===null){if((K.key==="ArrowDown"||K.key==="ArrowUp")&&K.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(K.key)&&I===null){const{value:b}=l;let v=0;for(;v<b.length;){if(!b[v].disabled){p.value=b[v].key;break}v+=1}}}else{const{value:b}=l;let v=b.findIndex(N=>N.key===I);if(!~v)return{enterBehavior:null};if(K.key==="Enter"){const N=b[v];switch(C=((B=e.overrideDefaultNodeClickBehavior)===null||B===void 0?void 0:B.call(e,{option:N.rawNode}))||null,C){case"toggleCheck":s(N,!i.value.includes(N.key));break;case"toggleSelect":w(N);break;case"toggleExpand":y(N);break;case"none":break;case"default":default:C="default",w(N)}}else if(K.key==="ArrowDown")for(K.preventDefault(),v+=1;v<b.length;){if(!b[v].disabled){p.value=b[v].key;break}v+=1}else if(K.key==="ArrowUp")for(K.preventDefault(),v-=1;v>=0;){if(!b[v].disabled){p.value=b[v].key;break}v-=1}else if(K.key==="ArrowLeft"){const N=b[v];if(N.isLeaf||!r.value.includes(I)){const H=N.getParent();H&&(p.value=H.key)}else y(N)}else if(K.key==="ArrowRight"){const N=b[v];if(N.isLeaf)return{enterBehavior:null};if(!r.value.includes(I))y(N);else for(v+=1;v<b.length;){if(!b[v].disabled){p.value=b[v].key;break}v+=1}}}return{enterBehavior:C}}return{pendingNodeKeyRef:p,handleKeydown:U}}const An=Fe({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const l=He(Ze);function r(i){const{onCheck:s}=e;s&&s(i)}function c(i){r(i)}return{handleUpdateValue:c,mergedTheme:l.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:l,checked:r,indeterminate:c,disabled:i,focusable:s,indent:w,handleUpdateValue:y}=this;return g("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${w}px`},"data-checkbox":!0},g(xn,{focusable:s,disabled:i,theme:l.peers.Checkbox,themeOverrides:l.peerOverrides.Checkbox,checked:r,indeterminate:c,onUpdateChecked:y}))}}),Ln=Fe({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:l,renderPrefixRef:r,renderSuffixRef:c,labelFieldRef:i}=He(Ze),s=A(null);function w(x){const{onClick:k}=e;k&&k(x)}function y(x){w(x)}return{selfRef:s,renderLabel:l,renderPrefix:r,renderSuffix:c,labelField:i,handleClick:y}},render(){const{clsPrefix:e,labelField:l,nodeProps:r,checked:c=!1,selected:i=!1,renderLabel:s,renderPrefix:w,renderSuffix:y,handleClick:x,onDragstart:k,tmNode:{rawNode:p,rawNode:{prefix:U,suffix:K,[l]:B}}}=this;return g("span",Object.assign({},r,{ref:"selfRef",class:[`${e}-tree-node-content`,r==null?void 0:r.class],onClick:x,draggable:k===void 0?void 0:!0,onDragstart:k}),w||U?g("div",{class:`${e}-tree-node-content__prefix`},w?w({option:p,selected:i,checked:c}):mt(U)):null,g("div",{class:`${e}-tree-node-content__text`},s?s({option:p,selected:i,checked:c}):mt(B)),y||K?g("div",{class:`${e}-tree-node-content__suffix`},y?y({option:p,selected:i,checked:c}):mt(K)):null)}}),En=Fe({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:l}=He(Ze,null);return()=>{const{clsPrefix:r,expanded:c,hide:i,indent:s,onClick:w}=e;return g("span",{"data-switcher":!0,class:[`${r}-tree-node-switcher`,c&&`${r}-tree-node-switcher--expanded`,i&&`${r}-tree-node-switcher--hide`],style:{width:`${s}px`},onClick:w},g("div",{class:`${r}-tree-node-switcher__icon`},g(en,null,{default:()=>{if(e.loading)return g(tn,{clsPrefix:r,key:"loading",radius:85,strokeWidth:20});const{value:y}=l;return y?y({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):g(nn,{clsPrefix:r,key:"switcher"},{default:()=>g(Dn,null)})}})))}}});function Vt(e){return D(()=>e.leafOnly?"child":e.checkStrategy)}function Te(e,l){return!!e.rawNode[l]}function Ht(e,l,r,c){e==null||e.forEach(i=>{r(i),Ht(i[l],l,r,c),c(i)})}function Bn(e,l,r,c,i){const s=new Set,w=new Set,y=[];return Ht(e,c,x=>{if(y.push(x),i(l,x)){w.add(x[r]);for(let k=y.length-2;k>=0;--k)if(!s.has(y[k][r]))s.add(y[k][r]);else return}},()=>{y.pop()}),{expandedKeys:Array.from(s),highlightKeySet:w}}if(ln&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function In(e,l,r,c,i){const s=new Set,w=new Set,y=new Set,x=[],k=[],p=[];function U(B){B.forEach(I=>{if(p.push(I),l(r,I)){s.add(I[c]),y.add(I[c]);for(let b=p.length-2;b>=0;--b){const v=p[b][c];if(!w.has(v))w.add(v),s.has(v)&&s.delete(v);else break}}const C=I[i];C&&U(C),p.pop()})}U(e);function K(B,I){B.forEach(C=>{const b=C[c],v=s.has(b),N=w.has(b);if(!v&&!N)return;const H=C[i];if(H)if(v)I.push(C);else{x.push(b);const L=Object.assign(Object.assign({},C),{[i]:[]});I.push(L),K(H,L[i])}else I.push(C)})}return K(e,k),{filteredTree:k,highlightKeySet:y,expandedKeys:x}}const qt=Fe({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const l=He(Ze),{droppingNodeParentRef:r,droppingMouseNodeRef:c,draggingNodeRef:i,droppingPositionRef:s,droppingOffsetLevelRef:w,nodePropsRef:y,indentRef:x,blockLineRef:k,checkboxPlacementRef:p,checkOnClickRef:U,disabledFieldRef:K,showLineRef:B,renderSwitcherIconRef:I,overrideDefaultNodeClickBehaviorRef:C}=l,b=Z(()=>!!e.tmNode.rawNode.checkboxDisabled),v=Z(()=>Te(e.tmNode,K.value)),N=Z(()=>l.disabledRef.value||v.value),H=D(()=>{const{value:u}=y;if(u)return u({option:e.tmNode.rawNode})}),L=A(null),Q={value:null};mn(()=>{Q.value=L.value.$el});function W(){const u=()=>{const{tmNode:R}=e;if(!R.isLeaf&&!R.shallowLoaded){if(!l.loadingKeysRef.value.has(R.key))l.loadingKeysRef.value.add(R.key);else return;const{onLoadRef:{value:_}}=l;_&&_(R.rawNode).then(M=>{M!==!1&&l.handleSwitcherClick(R)}).finally(()=>{l.loadingKeysRef.value.delete(R.key)})}else l.handleSwitcherClick(R)};I.value?setTimeout(u,0):u()}const fe=Z(()=>!v.value&&l.selectableRef.value&&(l.internalTreeSelect?l.mergedCheckStrategyRef.value!=="child"||l.multipleRef.value&&l.cascadeRef.value||e.tmNode.isLeaf:!0)),G=Z(()=>l.checkableRef.value&&(l.cascadeRef.value||l.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),he=Z(()=>l.displayedCheckedKeysRef.value.includes(e.tmNode.key)),ge=Z(()=>{const{value:u}=G;if(!u)return!1;const{value:R}=U,{tmNode:_}=e;return typeof R=="boolean"?!_.disabled&&R:R(e.tmNode.rawNode)});function ve(u){const{value:R}=l.expandOnClickRef,{value:_}=fe,{value:M}=ge;if(!_&&!R&&!M||Ve(u,"checkbox")||Ve(u,"switcher"))return;const{tmNode:q}=e;_&&l.handleSelect(q),R&&!q.isLeaf&&W(),M&&Y(!he.value)}function pe(u){var R,_;if(!(Ve(u,"checkbox")||Ve(u,"switcher"))){if(!N.value){const M=C.value;let q=!1;if(M)switch(M({option:e.tmNode.rawNode})){case"toggleCheck":q=!0,Y(!he.value);break;case"toggleSelect":q=!0,l.handleSelect(e.tmNode);break;case"toggleExpand":q=!0,W(),q=!0;break;case"none":q=!0,q=!0;return}q||ve(u)}(_=(R=H.value)===null||R===void 0?void 0:R.onClick)===null||_===void 0||_.call(R,u)}}function qe(u){k.value||pe(u)}function ee(u){k.value&&pe(u)}function Y(u){l.handleCheck(e.tmNode,u)}function ye(u){l.handleDragStart({event:u,node:e.tmNode})}function Ee(u){u.currentTarget===u.target&&l.handleDragEnter({event:u,node:e.tmNode})}function ne(u){u.preventDefault(),l.handleDragOver({event:u,node:e.tmNode})}function be(u){l.handleDragEnd({event:u,node:e.tmNode})}function De(u){u.currentTarget===u.target&&l.handleDragLeave({event:u,node:e.tmNode})}function Se(u){u.preventDefault(),s.value!==null&&l.handleDrop({event:u,node:e.tmNode,dropPosition:s.value})}const Be=D(()=>{const{clsPrefix:u}=e,{value:R}=x;if(B.value){const _=[];let M=e.tmNode.parent;for(;M;)M.isLastChild?_.push(g("div",{class:`${u}-tree-node-indent`},g("div",{style:{width:`${R}px`}}))):_.push(g("div",{class:[`${u}-tree-node-indent`,`${u}-tree-node-indent--show-line`]},g("div",{style:{width:`${R}px`}}))),M=M.parent;return _.reverse()}else return an(e.tmNode.level,g("div",{class:`${e.clsPrefix}-tree-node-indent`},g("div",{style:{width:`${R}px`}})))});return{showDropMark:Z(()=>{const{value:u}=i;if(!u)return;const{value:R}=s;if(!R)return;const{value:_}=c;if(!_)return;const{tmNode:M}=e;return M.key===_.key}),showDropMarkAsParent:Z(()=>{const{value:u}=r;if(!u)return!1;const{tmNode:R}=e,{value:_}=s;return _==="before"||_==="after"?u.key===R.key:!1}),pending:Z(()=>l.pendingNodeKeyRef.value===e.tmNode.key),loading:Z(()=>l.loadingKeysRef.value.has(e.tmNode.key)),highlight:Z(()=>{var u;return(u=l.highlightKeySetRef.value)===null||u===void 0?void 0:u.has(e.tmNode.key)}),checked:he,indeterminate:Z(()=>l.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:Z(()=>l.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:Z(()=>l.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:N,checkable:G,mergedCheckOnClick:ge,checkboxDisabled:b,selectable:fe,expandOnClick:l.expandOnClickRef,internalScrollable:l.internalScrollableRef,draggable:l.draggableRef,blockLine:k,nodeProps:H,checkboxFocusable:l.internalCheckboxFocusableRef,droppingPosition:s,droppingOffsetLevel:w,indent:x,checkboxPlacement:p,showLine:B,contentInstRef:L,contentElRef:Q,indentNodes:Be,handleCheck:Y,handleDrop:Se,handleDragStart:ye,handleDragEnter:Ee,handleDragOver:ne,handleDragEnd:be,handleDragLeave:De,handleLineClick:ee,handleContentClick:qe,handleSwitcherClick:W}},render(){const{tmNode:e,clsPrefix:l,checkable:r,expandOnClick:c,selectable:i,selected:s,checked:w,highlight:y,draggable:x,blockLine:k,indent:p,indentNodes:U,disabled:K,pending:B,internalScrollable:I,nodeProps:C,checkboxPlacement:b}=this,v=x&&!K?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,N=I?zt(e.key):void 0,H=b==="right",L=r?g(An,{indent:p,right:H,focusable:this.checkboxFocusable,disabled:K||this.checkboxDisabled,clsPrefix:l,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return g("div",Object.assign({class:`${l}-tree-node-wrapper`},v),g("div",Object.assign({},k?C:void 0,{class:[`${l}-tree-node`,{[`${l}-tree-node--selected`]:s,[`${l}-tree-node--checkable`]:r,[`${l}-tree-node--highlight`]:y,[`${l}-tree-node--pending`]:B,[`${l}-tree-node--disabled`]:K,[`${l}-tree-node--selectable`]:i,[`${l}-tree-node--clickable`]:i||c||this.mergedCheckOnClick},C==null?void 0:C.class],"data-key":N,draggable:x&&k,onClick:this.handleLineClick,onDragstart:x&&k&&!K?this.handleDragStart:void 0}),U,e.isLeaf&&this.showLine?g("div",{class:[`${l}-tree-node-indent`,`${l}-tree-node-indent--show-line`,e.isLeaf&&`${l}-tree-node-indent--is-leaf`,e.isLastChild&&`${l}-tree-node-indent--last-child`]},g("div",{style:{width:`${p}px`}})):g(En,{clsPrefix:l,expanded:this.expanded,selected:s,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:p,onClick:this.handleSwitcherClick}),H?null:L,g(Ln,{ref:"contentInstRef",clsPrefix:l,checked:w,selected:s,onClick:this.handleContentClick,nodeProps:k?void 0:C,onDragstart:x&&!k&&!K?this.handleDragStart:void 0,tmNode:e}),x?this.showDropMark?Et({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:p}):this.showDropMarkAsParent?Et({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:p}):null:null,H?L:null))}}),_n=Fe({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return g(on,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>g("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:Ut(this.height)}},this.nodes.map(l=>g(qt,{clsPrefix:e,tmNode:l})))})}}),xt=rn(),Un=O("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[se("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),se(">",[O("tree-node",[se("&:first-child","margin-top: 0;")])]),O("tree-motion-wrapper",[j("expand",[Pt({duration:"0.2s"})]),j("collapse",[Pt({duration:"0.2s",reverse:!0})])]),O("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),O("tree-node",`
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[j("highlight",[O("tree-node-content",[ke("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),j("disabled",[O("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),ze("disabled",[j("clickable",[O("tree-node-content",`
 cursor: pointer;
 `)])])]),j("block-node",[O("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),ze("block-line",[O("tree-node",[ze("disabled",[O("tree-node-content",[se("&:hover","background: var(--n-node-color-hover);")]),j("selectable",[O("tree-node-content",[se("&:active","background: var(--n-node-color-pressed);")])]),j("pending",[O("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),j("selected",[O("tree-node-content","background: var(--n-node-color-active);")])]),j("selected",[O("tree-node-content","background: var(--n-node-color-active);")])])]),j("block-line",[O("tree-node",[ze("disabled",[se("&:hover","background: var(--n-node-color-hover);"),j("pending",`
 background: var(--n-node-color-hover);
 `),j("selectable",[ze("selected",[se("&:active","background: var(--n-node-color-pressed);")])]),j("selected","background: var(--n-node-color-active);")]),j("selected","background: var(--n-node-color-active);"),j("disabled",`
 cursor: not-allowed;
 `)])]),j("ellipsis",[O("tree-node",[O("tree-node-content",`
 overflow: hidden;
 `,[ke("text",`
 text-overflow: ellipsis;
 white-space: nowrap;
 overflow: hidden;
 `)])])]),O("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[j("show-line","position: relative",[se("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),j("last-child",[se("&::before",`
 bottom: 50%;
 `)]),j("is-leaf",[se("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),ze("show-line","height: 0;")]),O("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[ke("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[O("icon",[xt]),O("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[xt]),O("base-icon",[xt])]),j("hide","visibility: hidden;"),j("expanded","transform: rotate(90deg);")]),O("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),O("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[se("&:last-child","margin-bottom: 0;"),ke("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),ke("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),ke("suffix",`
 display: inline-flex;
 `)]),ke("empty","margin: auto;")]);var $n=function(e,l,r,c){function i(s){return s instanceof r?s:new r(function(w){w(s)})}return new(r||(r=Promise))(function(s,w){function y(p){try{k(c.next(p))}catch(U){w(U)}}function x(p){try{k(c.throw(p))}catch(U){w(U)}}function k(p){p.done?s(p.value):i(p.value).then(y,x)}k((c=c.apply(e,[])).next())})};function Ct(e,l,r,c){return{getIsGroup(){return!1},getKey(s){return s[e]},getChildren:c||(s=>s[l]),getDisabled(s){return!!(s[r]||s.checkboxDisabled)}}}const Wt={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indent:{type:Number,default:24},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},Mn=Object.assign(Object.assign(Object.assign(Object.assign({},rt.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,allowDrop:{type:Function,default:Pn},animated:{type:Boolean,default:!0},ellipsis:Boolean,checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),Wt),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),jn=Fe({name:"Tree",props:Mn,slots:Object,setup(e){const{mergedClsPrefixRef:l,inlineThemeDisabled:r,mergedRtlRef:c}=$t(e),i=dn("Tree",c,l),s=rt("Tree","-tree",Un,sn,e,l),w=A(null),y=A(null),x=A(null);function k(){var t;return(t=x.value)===null||t===void 0?void 0:t.listElRef}function p(){var t;return(t=x.value)===null||t===void 0?void 0:t.itemsElRef}const U=D(()=>{const{filter:t}=e;if(t)return t;const{labelField:a}=e;return(o,f)=>{if(!o.length)return!0;const h=f[a];return typeof h=="string"?h.toLowerCase().includes(o.toLowerCase()):!1}}),K=D(()=>{const{pattern:t}=e;return t?!t.length||!U.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:In(e.data,U.value,t,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),B=D(()=>pt(e.showIrrelevantNodes?e.data:K.value.filteredTree,Ct(e.keyField,e.childrenField,e.disabledField,e.getChildren))),I=He(Nt,null),C=e.internalTreeSelect?I.dataTreeMate:D(()=>e.showIrrelevantNodes?B.value:pt(e.data,Ct(e.keyField,e.childrenField,e.disabledField,e.getChildren))),{watchProps:b}=e,v=A([]);b!=null&&b.includes("defaultCheckedKeys")?Je(()=>{v.value=e.defaultCheckedKeys}):v.value=e.defaultCheckedKeys;const N=F(e,"checkedKeys"),H=Le(N,v),L=D(()=>C.value.getCheckedKeys(H.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),Q=Vt(e),W=D(()=>L.value.checkedKeys),fe=D(()=>{const{indeterminateKeys:t}=e;return t!==void 0?t:L.value.indeterminateKeys}),G=A([]);b!=null&&b.includes("defaultSelectedKeys")?Je(()=>{G.value=e.defaultSelectedKeys}):G.value=e.defaultSelectedKeys;const he=F(e,"selectedKeys"),ge=Le(he,G),ve=A([]),pe=t=>{ve.value=e.defaultExpandAll?C.value.getNonLeafKeys():t===void 0?e.defaultExpandedKeys:t};b!=null&&b.includes("defaultExpandedKeys")?Je(()=>{pe(void 0)}):Je(()=>{pe(e.defaultExpandedKeys)});const qe=F(e,"expandedKeys"),ee=Le(qe,ve),Y=D(()=>B.value.getFlattenedNodes(ee.value)),{pendingNodeKeyRef:ye,handleKeydown:Ee}=On({props:e,mergedCheckedKeysRef:H,mergedSelectedKeysRef:ge,fNodesRef:Y,mergedExpandedKeysRef:ee,handleCheck:d,handleSelect:T,handleSwitcherClick:m});let ne=null,be=null;const De=A(new Set),Se=D(()=>e.internalHighlightKeySet||K.value.highlightKeySet),Be=Le(Se,De),u=A(new Set),R=D(()=>ee.value.filter(t=>!u.value.has(t)));let _=0;const M=A(null),q=A(null),Pe=A(null),le=A(null),Re=A(0),dt=D(()=>{const{value:t}=q;return t?t.parent:null});let We=!1;ot(F(e,"data"),()=>{We=!0,it(()=>{We=!1}),u.value.clear(),ye.value=null,Ne()},{deep:!1});let Ge=!1;const ce=()=>{Ge=!0,it(()=>{Ge=!1})};let Oe;ot(F(e,"pattern"),(t,a)=>{if(e.showIrrelevantNodes)if(Oe=void 0,t){const{expandedKeys:o,highlightKeySet:f}=Bn(e.data,e.pattern,e.keyField,e.childrenField,U.value);De.value=f,ce(),xe(o,J(o),{node:null,action:"filter"})}else De.value=new Set;else if(!t.length)Oe!==void 0&&(ce(),xe(Oe,J(Oe),{node:null,action:"filter"}));else{a.length||(Oe=ee.value);const{expandedKeys:o}=K.value;o!==void 0&&(ce(),xe(o,J(o),{node:null,action:"filter"}))}});function et(t){return $n(this,void 0,void 0,function*(){const{onLoad:a}=e;if(!a){yield Promise.resolve();return}const{value:o}=u;if(!o.has(t.key)){o.add(t.key);try{(yield a(t.rawNode))===!1&&n()}catch(f){console.error(f),n()}o.delete(t.key)}})}Je(()=>{var t;const{value:a}=B;if(!a)return;const{getNode:o}=a;(t=ee.value)===null||t===void 0||t.forEach(f=>{const h=o(f);h&&!h.shallowLoaded&&et(h)})});const Ce=A(!1),me=A([]);ot(R,(t,a)=>{if(!e.animated||Ge){it(Ie);return}if(We)return;const o=Qe(s.value.self.nodeHeight),f=new Set(a);let h=null,$=null;for(const E of t)if(!f.has(E)){if(h!==null)return;h=E}const te=new Set(t);for(const E of a)if(!te.has(E)){if($!==null)return;$=E}if(h===null&&$===null)return;const{virtualScroll:oe}=e,$e=(oe?x.value.listElRef:w.value).offsetHeight,Me=Math.ceil($e/o)+1;let re;if(h!==null&&(re=a),$!==null&&(re===void 0?re=t:re=re.filter(E=>E!==$)),Ce.value=!0,me.value=B.value.getFlattenedNodes(re),h!==null){const E=me.value.findIndex(de=>de.key===h);if(~E){const de=me.value[E].children;if(de){const ue=Lt(de,t);me.value.splice(E+1,0,{__motion:!0,mode:"expand",height:oe?ue.length*o:void 0,nodes:oe?ue.slice(0,Me):ue})}}}if($!==null){const E=me.value.findIndex(de=>de.key===$);if(~E){const de=me.value[E].children;if(!de)return;Ce.value=!0;const ue=Lt(de,t);me.value.splice(E+1,0,{__motion:!0,mode:"collapse",height:oe?ue.length*o:void 0,nodes:oe?ue.slice(0,Me):ue})}}});const st=D(()=>Sn(Y.value)),ct=D(()=>Ce.value?me.value:Y.value);function Ie(){const{value:t}=y;t&&t.sync()}function ut(){Ce.value=!1,e.virtualScroll&&it(Ie)}function J(t){const{getNode:a}=C.value;return t.map(o=>{var f;return((f=a(o))===null||f===void 0?void 0:f.rawNode)||null})}function xe(t,a,o){const{"onUpdate:expandedKeys":f,onUpdateExpandedKeys:h}=e;ve.value=t,f&&z(f,t,a,o),h&&z(h,t,a,o)}function tt(t,a,o){const{"onUpdate:checkedKeys":f,onUpdateCheckedKeys:h}=e;v.value=t,h&&z(h,t,a,o),f&&z(f,t,a,o)}function ft(t,a){const{"onUpdate:indeterminateKeys":o,onUpdateIndeterminateKeys:f}=e;o&&z(o,t,a),f&&z(f,t,a)}function Xe(t,a,o){const{"onUpdate:selectedKeys":f,onUpdateSelectedKeys:h}=e;G.value=t,h&&z(h,t,a,o),f&&z(f,t,a,o)}function ht(t){const{onDragenter:a}=e;a&&z(a,t)}function nt(t){const{onDragleave:a}=e;a&&z(a,t)}function gt(t){const{onDragend:a}=e;a&&z(a,t)}function lt(t){const{onDragstart:a}=e;a&&z(a,t)}function vt(t){const{onDragover:a}=e;a&&z(a,t)}function Ye(t){const{onDrop:a}=e;a&&z(a,t)}function Ne(){Ke(),we()}function Ke(){M.value=null}function we(){Re.value=0,q.value=null,Pe.value=null,le.value=null,n()}function n(){ne&&(window.clearTimeout(ne),ne=null),be=null}function d(t,a){if(e.disabled||Te(t,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){T(t);return}const o=a?"check":"uncheck",{checkedKeys:f,indeterminateKeys:h}=C.value[o](t.key,W.value,{cascade:e.cascade,checkStrategy:Q.value,allowNotLoaded:e.allowCheckingNotLoaded});tt(f,J(f),{node:t.rawNode,action:o}),ft(h,J(h))}function S(t){if(e.disabled)return;const{key:a}=t,{value:o}=ee,f=o.findIndex(h=>h===a);if(~f){const h=Array.from(o);h.splice(f,1),xe(h,J(h),{node:t.rawNode,action:"collapse"})}else{const h=B.value.getNode(a);if(!h||h.isLeaf)return;let $;if(e.accordion){const te=new Set(t.siblings.map(({key:oe})=>oe));$=o.filter(oe=>!te.has(oe)),$.push(a)}else $=o.concat(a);xe($,J($),{node:t.rawNode,action:"expand"})}}function m(t){e.disabled||Ce.value||S(t)}function T(t){if(!(e.disabled||!e.selectable)){if(ye.value=t.key,e.internalUnifySelectCheck){const{value:{checkedKeys:a,indeterminateKeys:o}}=L;e.multiple?d(t,!(a.includes(t.key)||o.includes(t.key))):tt([t.key],J([t.key]),{node:t.rawNode,action:"check"})}if(e.multiple){const a=Array.from(ge.value),o=a.findIndex(f=>f===t.key);~o?e.cancelable&&a.splice(o,1):~o||a.push(t.key),Xe(a,J(a),{node:t.rawNode,action:~o?"unselect":"select"})}else ge.value.includes(t.key)?e.cancelable&&Xe([],[],{node:t.rawNode,action:"unselect"}):Xe([t.key],J([t.key]),{node:t.rawNode,action:"select"})}}function V(t){if(ne&&(window.clearTimeout(ne),ne=null),t.isLeaf)return;be=t.key;const a=()=>{if(be!==t.key)return;const{value:o}=Pe;if(o&&o.key===t.key&&!ee.value.includes(t.key)){const f=ee.value.concat(t.key);xe(f,J(f),{node:t.rawNode,action:"expand"})}ne=null,be=null};t.shallowLoaded?ne=window.setTimeout(()=>{a()},1e3):ne=window.setTimeout(()=>{et(t).then(()=>{a()})},1e3)}function ie({event:t,node:a}){!e.draggable||e.disabled||Te(a,e.disabledField)||(Kt({event:t,node:a},!1),ht({event:t,node:a.rawNode}))}function ae({event:t,node:a}){!e.draggable||e.disabled||Te(a,e.disabledField)||nt({event:t,node:a.rawNode})}function _e(t){t.target===t.currentTarget&&we()}function Ae({event:t,node:a}){Ne(),!(!e.draggable||e.disabled||Te(a,e.disabledField))&&gt({event:t,node:a.rawNode})}function yt({event:t,node:a}){!e.draggable||e.disabled||Te(a,e.disabledField)||(_=t.clientX,M.value=a,lt({event:t,node:a.rawNode}))}function Kt({event:t,node:a},o=!0){var f;if(!e.draggable||e.disabled||Te(a,e.disabledField))return;const{value:h}=M;if(!h)return;const{allowDrop:$,indent:te}=e;o&&vt({event:t,node:a.rawNode});const oe=t.currentTarget,{height:$e,top:Me}=oe.getBoundingClientRect(),re=t.clientY-Me;let E;$({node:a.rawNode,dropPosition:"inside",phase:"drag"})?re<=8?E="before":re>=$e-8?E="after":E="inside":re<=$e/2?E="before":E="after";const{value:ue}=st;let P,X;const je=ue(a.key);if(je===null){we();return}let at=!1;E==="inside"?(P=a,X="inside"):E==="before"?a.isFirstChild?(P=a,X="before"):(P=Y.value[je-1],X="after"):(P=a,X="after"),!P.isLeaf&&ee.value.includes(P.key)&&(at=!0,X==="after"&&(P=Y.value[je+1],P?X="before":(P=a,X="inside")));const Ft=P;if(Pe.value=Ft,!at&&h.isLastChild&&h.key===P.key&&(X="after"),X==="after"){let Dt=_-t.clientX,bt=0;for(;Dt>=te/2&&P.parent!==null&&P.isLastChild&&bt<1;)Dt-=te,bt+=1,P=P.parent;Re.value=bt}else Re.value=0;if((h.contains(P)||X==="inside"&&((f=h.parent)===null||f===void 0?void 0:f.key)===P.key)&&!(h.key===Ft.key&&h.key===P.key)){we();return}if(!$({node:P.rawNode,dropPosition:X,phase:"drag"})){we();return}if(h.key===P.key)n();else if(be!==P.key)if(X==="inside"){if(e.expandOnDragenter){if(V(P),!P.shallowLoaded&&be!==P.key){Ne();return}}else if(!P.shallowLoaded){Ne();return}}else n();else X!=="inside"&&n();le.value=X,q.value=P}function Gt({event:t,node:a,dropPosition:o}){if(!e.draggable||e.disabled||Te(a,e.disabledField))return;const{value:f}=M,{value:h}=q,{value:$}=le;if(!(!f||!h||!$)&&e.allowDrop({node:h.rawNode,dropPosition:$,phase:"drag"})&&f.key!==h.key){if($==="before"){const te=f.getNext({includeDisabled:!0});if(te&&te.key===h.key){we();return}}if($==="after"){const te=f.getPrev({includeDisabled:!0});if(te&&te.key===h.key){we();return}}Ye({event:t,node:h.rawNode,dragNode:f.rawNode,dropPosition:o}),Ne()}}function Xt(){Ie()}function Yt(){Ie()}function Qt(t){var a;if(e.virtualScroll||e.internalScrollable){const{value:o}=y;if(!((a=o==null?void 0:o.containerRef)===null||a===void 0)&&a.contains(t.relatedTarget))return;ye.value=null}else{const{value:o}=w;if(o!=null&&o.contains(t.relatedTarget))return;ye.value=null}}ot(ye,t=>{var a,o;if(t!==null){if(e.virtualScroll)(a=x.value)===null||a===void 0||a.scrollTo({key:t});else if(e.internalScrollable){const{value:f}=y;if(f===null)return;const h=(o=f.contentRef)===null||o===void 0?void 0:o.querySelector(`[data-key="${zt(t)}"]`);if(!h)return;f.scrollTo({el:h})}}}),jt(Ze,{loadingKeysRef:u,highlightKeySetRef:Be,displayedCheckedKeysRef:W,displayedIndeterminateKeysRef:fe,mergedSelectedKeysRef:ge,mergedExpandedKeysRef:ee,mergedThemeRef:s,mergedCheckStrategyRef:Q,nodePropsRef:F(e,"nodeProps"),disabledRef:F(e,"disabled"),checkableRef:F(e,"checkable"),selectableRef:F(e,"selectable"),expandOnClickRef:F(e,"expandOnClick"),onLoadRef:F(e,"onLoad"),draggableRef:F(e,"draggable"),blockLineRef:F(e,"blockLine"),indentRef:F(e,"indent"),cascadeRef:F(e,"cascade"),checkOnClickRef:F(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Pe,droppingNodeParentRef:dt,draggingNodeRef:M,droppingPositionRef:le,droppingOffsetLevelRef:Re,fNodesRef:Y,pendingNodeKeyRef:ye,showLineRef:F(e,"showLine"),disabledFieldRef:F(e,"disabledField"),internalScrollableRef:F(e,"internalScrollable"),internalCheckboxFocusableRef:F(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:F(e,"renderLabel"),renderPrefixRef:F(e,"renderPrefix"),renderSuffixRef:F(e,"renderSuffix"),renderSwitcherIconRef:F(e,"renderSwitcherIcon"),labelFieldRef:F(e,"labelField"),multipleRef:F(e,"multiple"),overrideDefaultNodeClickBehaviorRef:F(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:m,handleDragEnd:Ae,handleDragEnter:ie,handleDragLeave:ae,handleDragStart:yt,handleDrop:Gt,handleDragOver:Kt,handleSelect:T,handleCheck:d});function Jt(t,a){var o,f;typeof t=="number"?(o=x.value)===null||o===void 0||o.scrollTo(t,a||0):(f=x.value)===null||f===void 0||f.scrollTo(t)}const Zt={handleKeydown:Ee,scrollTo:Jt,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:t}=L.value;return{keys:t,options:J(t)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:t}=L.value;return{keys:t,options:J(t)}}},Tt=D(()=>{const{common:{cubicBezierEaseInOut:t},self:{fontSize:a,nodeBorderRadius:o,nodeColorHover:f,nodeColorPressed:h,nodeColorActive:$,arrowColor:te,loadingColor:oe,nodeTextColor:$e,nodeTextColorDisabled:Me,dropMarkColor:re,nodeWrapperPadding:E,nodeHeight:de,lineHeight:ue,lineColor:P}}=s.value,X=kt(E,"top"),je=kt(E,"bottom"),at=Ut(Qe(de)-Qe(X)-Qe(je));return{"--n-arrow-color":te,"--n-loading-color":oe,"--n-bezier":t,"--n-font-size":a,"--n-node-border-radius":o,"--n-node-color-active":$,"--n-node-color-hover":f,"--n-node-color-pressed":h,"--n-node-text-color":$e,"--n-node-text-color-disabled":Me,"--n-drop-mark-color":re,"--n-node-wrapper-padding":E,"--n-line-offset-top":`-${X}`,"--n-line-offset-bottom":`-${je}`,"--n-node-content-height":at,"--n-line-height":ue,"--n-line-color":P}}),Ue=r?Mt("tree",void 0,Tt,e):void 0;return Object.assign(Object.assign({},Zt),{mergedClsPrefix:l,mergedTheme:s,rtlEnabled:i,fNodes:ct,aip:Ce,selfElRef:w,virtualListInstRef:x,scrollbarInstRef:y,handleFocusout:Qt,handleDragLeaveTree:_e,handleScroll:Xt,getScrollContainer:k,getScrollContent:p,handleAfterEnter:ut,handleResize:Yt,cssVars:r?void 0:Tt,themeClass:Ue==null?void 0:Ue.themeClass,onRender:Ue==null?void 0:Ue.onRender})},render(){var e;const{fNodes:l,internalRenderEmpty:r}=this;if(!l.length&&r)return r();const{mergedClsPrefix:c,blockNode:i,blockLine:s,draggable:w,disabled:y,ellipsis:x,internalFocusable:k,checkable:p,handleKeydown:U,rtlEnabled:K,handleFocusout:B,scrollbarProps:I}=this,C=k&&!y,b=C?"0":void 0,v=[`${c}-tree`,K&&`${c}-tree--rtl`,p&&`${c}-tree--checkable`,(s||i)&&`${c}-tree--block-node`,s&&`${c}-tree--block-line`,x&&`${c}-tree--ellipsis`],N=L=>"__motion"in L?g(_n,{height:L.height,nodes:L.nodes,clsPrefix:c,mode:L.mode,onAfterEnter:this.handleAfterEnter}):g(qt,{key:L.key,tmNode:L,clsPrefix:c});if(this.virtualScroll){const{mergedTheme:L,internalScrollablePadding:Q}=this,W=kt(Q||"0");return g(Ot,Object.assign({},I,{ref:"scrollbarInstRef",onDragleave:w?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:v,theme:L.peers.Scrollbar,themeOverrides:L.peerOverrides.Scrollbar,tabindex:b,onKeydown:C?U:void 0,onFocusout:C?B:void 0}),{default:()=>{var fe;return(fe=this.onRender)===null||fe===void 0||fe.call(this),l.length?g(pn,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Qe(L.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:W.top,paddingBottom:W.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:W.left,paddingRight:W.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:G})=>N(G)}):wt(this.$slots.empty,()=>[g(St,{class:`${c}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:H}=this;return v.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),H?g(Ot,Object.assign({},I,{class:v,tabindex:b,onKeydown:C?U:void 0,onFocusout:C?B:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>g("div",{onDragleave:w?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(N))}):g("div",{class:v,tabindex:b,ref:"selfElRef",style:this.cssVars,onKeydown:C?U:void 0,onFocusout:C?B:void 0,onDragleave:w?this.handleDragLeaveTree:void 0},l.length?l.map(N):wt(this.$slots.empty,()=>[g(St,{class:`${c}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),zn=se([O("tree-select",`
 z-index: auto;
 outline: none;
 width: 100%;
 position: relative;
 `),O("tree-select-menu",`
 position: relative;
 overflow: hidden;
 margin: 4px 0;
 transition: box-shadow .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-menu-border-radius);
 box-shadow: var(--n-menu-box-shadow);
 background-color: var(--n-menu-color);
 outline: none;
 `,[O("tree","max-height: var(--n-menu-height);"),ke("empty",`
 display: flex;
 padding: 12px 32px;
 flex: 1;
 justify-content: center;
 `),ke("header",`
 padding: var(--n-header-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-header-divider-color);
 color: var(--n-header-text-color);
 `),ke("action",`
 padding: var(--n-action-padding);
 transition: 
 color .3s var(--n-bezier);
 border-color .3s var(--n-bezier);
 border-top: 1px solid var(--n-action-divider-color);
 color: var(--n-action-text-color);
 `),cn()])]);function Bt(e,l){const{rawNode:r}=e;return Object.assign(Object.assign({},r),{label:r[l],value:e.key})}function It(e,l,r,c){const{rawNode:i}=e;return Object.assign(Object.assign({},i),{value:e.key,label:l.map(s=>s.rawNode[c]).join(r)})}const Vn=Object.assign(Object.assign(Object.assign(Object.assign({},rt.props),{bordered:{type:Boolean,default:!0},cascade:Boolean,checkable:Boolean,clearable:Boolean,clearFilterAfterSelect:{type:Boolean,default:!0},consistentMenuWidth:{type:Boolean,default:!0},defaultShow:Boolean,defaultValue:{type:[String,Number,Array],default:null},disabled:{type:Boolean,default:void 0},filterable:Boolean,checkStrategy:{type:String,default:"all"},loading:Boolean,maxTagCount:[String,Number],multiple:Boolean,showPath:Boolean,separator:{type:String,default:" / "},options:{type:Array,default:()=>[]},placeholder:String,placement:{type:String,default:"bottom-start"},show:{type:Boolean,default:void 0},size:String,value:[String,Number,Array],to:Rt.propTo,menuProps:Object,virtualScroll:{type:Boolean,default:!0},status:String,renderTag:Function,ellipsisTagPopoverProps:Object}),Wt),{renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,watchProps:Array,getChildren:Function,onBlur:Function,onFocus:Function,onLoad:Function,onUpdateShow:[Function,Array],onUpdateValue:[Function,Array],"onUpdate:value":[Function,Array],"onUpdate:show":[Function,Array],leafOnly:Boolean}),nl=Fe({name:"TreeSelect",props:Vn,slots:Object,setup(e){const l=A(null),r=A(null),c=A(null),i=A(null),{mergedClsPrefixRef:s,namespaceRef:w,inlineThemeDisabled:y}=$t(e),{localeRef:x}=Fn("Select"),{mergedSizeRef:k,mergedDisabledRef:p,mergedStatusRef:U,nTriggerFormBlur:K,nTriggerFormChange:B,nTriggerFormFocus:I,nTriggerFormInput:C}=hn(e),b=A(e.defaultValue),v=F(e,"value"),N=Le(v,b),H=A(e.defaultShow),L=F(e,"show"),Q=Le(L,H),W=A(""),fe=D(()=>{const{filter:n}=e;if(n)return n;const{labelField:d}=e;return(S,m)=>S.length?m[d].toLowerCase().includes(S.toLowerCase()):!0}),G=D(()=>pt(e.options,Ct(e.keyField,e.childrenField,e.disabledField,void 0))),{value:he}=N,ge=A(e.checkable?null:Array.isArray(he)&&he.length?he[he.length-1]:null),ve=D(()=>e.multiple&&e.cascade&&e.checkable),pe=A(e.defaultExpandAll?void 0:e.defaultExpandedKeys||e.expandedKeys),qe=F(e,"expandedKeys"),ee=Le(qe,pe),Y=A(!1),ye=D(()=>{const{placeholder:n}=e;return n!==void 0?n:x.value.placeholder}),Ee=D(()=>{const{value:n}=N;return e.multiple?Array.isArray(n)?n:[]:n===null||Array.isArray(n)?[]:[n]}),ne=D(()=>e.checkable?[]:Ee.value),be=D(()=>{const{multiple:n,showPath:d,separator:S,labelField:m}=e;if(n)return null;const{value:T}=N;if(!Array.isArray(T)&&T!==null){const{value:V}=G,ie=V.getNode(T);if(ie!==null)return d?It(ie,V.getPath(T).treeNodePath,S,m):Bt(ie,m)}return null}),De=D(()=>{const{multiple:n,showPath:d,separator:S}=e;if(!n)return null;const{value:m}=N;if(Array.isArray(m)){const T=[],{value:V}=G,{checkedKeys:ie}=V.getCheckedKeys(m,{checkStrategy:e.checkStrategy,cascade:ve.value,allowNotLoaded:e.allowCheckingNotLoaded}),{labelField:ae}=e;return ie.forEach(_e=>{const Ae=V.getNode(_e);Ae!==null&&T.push(d?It(Ae,V.getPath(_e).treeNodePath,S,ae):Bt(Ae,ae))}),T}return[]});function Se(){var n;(n=r.value)===null||n===void 0||n.focus()}function Be(){var n;(n=r.value)===null||n===void 0||n.focusInput()}function u(n){const{onUpdateShow:d,"onUpdate:show":S}=e;d&&z(d,n),S&&z(S,n),H.value=n}function R(n,d,S){const{onUpdateValue:m,"onUpdate:value":T}=e;m&&z(m,n,d,S),T&&z(T,n,d,S),b.value=n,C(),B()}function _(n,d){const{onUpdateIndeterminateKeys:S,"onUpdate:indeterminateKeys":m}=e;S&&z(S,n,d),m&&z(m,n,d)}function M(n,d,S){const{onUpdateExpandedKeys:m,"onUpdate:expandedKeys":T}=e;m&&z(m,n,d,S),T&&z(T,n,d,S),pe.value=n}function q(n){const{onFocus:d}=e;d&&d(n),I()}function Pe(n){le();const{onBlur:d}=e;d&&d(n),K()}function le(){u(!1)}function Re(){p.value||(W.value="",u(!0),e.filterable&&Be())}function dt(){W.value=""}function We(n){var d;Q.value&&(!((d=r.value)===null||d===void 0)&&d.$el.contains(vn(n))||le())}function Ge(){p.value||(Q.value?e.filterable||le():Re())}function ce(n){const{value:{getNode:d}}=G;return n.map(S=>{var m;return((m=d(S))===null||m===void 0?void 0:m.rawNode)||null})}function Oe(n,d,S){const m=ce(n),T=S.action==="check"?"select":"unselect",V=S.node;e.multiple?(R(n,m,{node:V,action:T}),e.filterable&&(Be(),e.clearFilterAfterSelect&&(W.value=""))):(n.length?R(n[0],m[0]||null,{node:V,action:T}):R(null,null,{node:V,action:T}),le(),Se())}function et(n){e.checkable&&_(n,ce(n))}function Ce(n){var d;!((d=i.value)===null||d===void 0)&&d.contains(n.relatedTarget)||(Y.value=!0,q(n))}function me(n){var d;!((d=i.value)===null||d===void 0)&&d.contains(n.relatedTarget)||(Y.value=!1,Pe(n))}function st(n){var d,S,m;!((d=i.value)===null||d===void 0)&&d.contains(n.relatedTarget)||!((m=(S=r.value)===null||S===void 0?void 0:S.$el)===null||m===void 0)&&m.contains(n.relatedTarget)||(Y.value=!0,q(n))}function ct(n){var d,S,m;!((d=i.value)===null||d===void 0)&&d.contains(n.relatedTarget)||!((m=(S=r.value)===null||S===void 0?void 0:S.$el)===null||m===void 0)&&m.contains(n.relatedTarget)||(Y.value=!1,Pe(n))}function Ie(n){n.stopPropagation();const{multiple:d}=e;!d&&e.filterable&&le(),d?R([],[],{node:null,action:"clear"}):R(null,null,{node:null,action:"clear"})}function ut(n){const{value:d}=N;if(Array.isArray(d)){const{value:S}=G,{checkedKeys:m}=S.getCheckedKeys(d,{cascade:ve.value,allowNotLoaded:e.allowCheckingNotLoaded}),T=m.findIndex(V=>V===n.value);if(~T){const V=m[T],ie=ce([V])[0];if(e.checkable){const{checkedKeys:ae}=S.uncheck(n.value,m,{checkStrategy:e.checkStrategy,cascade:ve.value,allowNotLoaded:e.allowCheckingNotLoaded});R(ae,ce(ae),{node:ie,action:"delete"})}else{const ae=Array.from(m);ae.splice(T,1),R(ae,ce(ae),{node:ie,action:"delete"})}}}}function J(n){const{value:d}=n.target;W.value=d}function xe(n){const{value:d}=c;return d?d.handleKeydown(n):{enterBehavior:null}}function tt(n){if(n.key==="Enter"){if(Q.value){const{enterBehavior:d}=xe(n);if(!e.multiple)switch(d){case"default":case"toggleSelect":le(),Se();break}}else Re();n.preventDefault()}else n.key==="Escape"?Q.value&&(yn(n),le(),Se()):Q.value?xe(n):n.key==="ArrowDown"&&Re()}function ft(){le(),Se()}function Xe(n){!Ve(n,"action")&&!Ve(n,"header")&&n.preventDefault()}const ht=D(()=>{const{renderTag:n}=e;if(n)return function({option:S,handleClose:m}){const{value:T}=S;if(T!==void 0){const V=G.value.getNode(T);if(V)return n({option:V.rawNode,handleClose:m})}return T}});jt(Nt,{pendingNodeKeyRef:ge,dataTreeMate:G});function nt(){var n;Q.value&&((n=l.value)===null||n===void 0||n.syncPosition())}Cn(i,nt);const gt=Vt(e),lt=D(()=>{if(e.checkable){const n=N.value;return e.multiple&&Array.isArray(n)?G.value.getCheckedKeys(n,{cascade:e.cascade,checkStrategy:gt.value,allowNotLoaded:e.allowCheckingNotLoaded}):{checkedKeys:Array.isArray(n)||n===null?[]:[n],indeterminateKeys:[]}}return{checkedKeys:[],indeterminateKeys:[]}}),vt={getCheckedData:()=>{const{checkedKeys:n}=lt.value;return{keys:n,options:ce(n)}},getIndeterminateData:()=>{const{indeterminateKeys:n}=lt.value;return{keys:n,options:ce(n)}},focus:()=>{var n;return(n=r.value)===null||n===void 0?void 0:n.focus()},focusInput:()=>{var n;return(n=r.value)===null||n===void 0?void 0:n.focusInput()},blur:()=>{var n;return(n=r.value)===null||n===void 0?void 0:n.blur()},blurInput:()=>{var n;return(n=r.value)===null||n===void 0?void 0:n.blurInput()}},Ye=rt("TreeSelect","-tree-select",zn,bn,e,s),Ne=D(()=>{const{common:{cubicBezierEaseInOut:n},self:{menuBoxShadow:d,menuBorderRadius:S,menuColor:m,menuHeight:T,actionPadding:V,actionDividerColor:ie,actionTextColor:ae,headerDividerColor:_e,headerPadding:Ae,headerTextColor:yt}}=Ye.value;return{"--n-menu-box-shadow":d,"--n-menu-border-radius":S,"--n-menu-color":m,"--n-menu-height":T,"--n-bezier":n,"--n-action-padding":V,"--n-action-text-color":ae,"--n-action-divider-color":ie,"--n-header-padding":Ae,"--n-header-text-color":yt,"--n-header-divider-color":_e}}),Ke=y?Mt("tree-select",void 0,Ne,e):void 0,we=D(()=>{const{self:{menuPadding:n}}=Ye.value;return n});return Object.assign(Object.assign({},vt),{menuElRef:i,mergedStatus:U,triggerInstRef:r,followerInstRef:l,treeInstRef:c,mergedClsPrefix:s,mergedValue:N,mergedShow:Q,namespace:w,adjustedTo:Rt(e),isMounted:gn(),focused:Y,menuPadding:we,mergedPlaceholder:ye,mergedExpandedKeys:ee,treeSelectedKeys:ne,treeCheckedKeys:Ee,mergedSize:k,mergedDisabled:p,selectedOption:be,selectedOptions:De,pattern:W,pendingNodeKey:ge,mergedCascade:ve,mergedFilter:fe,selectionRenderTag:ht,handleTriggerOrMenuResize:nt,doUpdateExpandedKeys:M,handleMenuLeave:dt,handleTriggerClick:Ge,handleMenuClickoutside:We,handleUpdateCheckedKeys:Oe,handleUpdateIndeterminateKeys:et,handleTriggerFocus:Ce,handleTriggerBlur:me,handleMenuFocusin:st,handleMenuFocusout:ct,handleClear:Ie,handleDeleteOption:ut,handlePatternInput:J,handleKeydown:tt,handleTabOut:ft,handleMenuMousedown:Xe,mergedTheme:Ye,cssVars:y?void 0:Ne,themeClass:Ke==null?void 0:Ke.themeClass,onRender:Ke==null?void 0:Ke.onRender})},render(){const{mergedTheme:e,mergedClsPrefix:l,$slots:r}=this;return g("div",{class:`${l}-tree-select`},g(Nn,null,{default:()=>[g(Kn,null,{default:()=>g(Rn,{ref:"triggerInstRef",onResize:this.handleTriggerOrMenuResize,status:this.mergedStatus,focused:this.focused,clsPrefix:l,theme:e.peers.InternalSelection,themeOverrides:e.peerOverrides.InternalSelection,ellipsisTagPopoverProps:this.ellipsisTagPopoverProps,renderTag:this.selectionRenderTag,selectedOption:this.selectedOption,selectedOptions:this.selectedOptions,size:this.mergedSize,bordered:this.bordered,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,active:this.mergedShow,loading:this.loading,multiple:this.multiple,maxTagCount:this.maxTagCount,showArrow:!0,filterable:this.filterable,clearable:this.clearable,pattern:this.pattern,onPatternInput:this.handlePatternInput,onClear:this.handleClear,onClick:this.handleTriggerClick,onFocus:this.handleTriggerFocus,onBlur:this.handleTriggerBlur,onDeleteOption:this.handleDeleteOption,onKeydown:this.handleKeydown},{arrow:()=>{var c,i;return[(i=(c=this.$slots).arrow)===null||i===void 0?void 0:i.call(c)]}})}),g(Tn,{ref:"followerInstRef",show:this.mergedShow,placement:this.placement,to:this.adjustedTo,teleportDisabled:this.adjustedTo===Rt.tdkey,containerClass:this.namespace,width:this.consistentMenuWidth?"target":void 0,minWidth:"target"},{default:()=>g(un,{name:"fade-in-scale-up-transition",appear:this.isMounted,onLeave:this.handleMenuLeave},{default:()=>{var c;if(!this.mergedShow)return null;const{mergedClsPrefix:i,checkable:s,multiple:w,menuProps:y,options:x}=this;return(c=this.onRender)===null||c===void 0||c.call(this),kn(g("div",Object.assign({},y,{class:[`${i}-tree-select-menu`,y==null?void 0:y.class,this.themeClass],ref:"menuElRef",style:[(y==null?void 0:y.style)||"",this.cssVars],tabindex:0,onMousedown:this.handleMenuMousedown,onKeydown:this.handleKeydown,onFocusin:this.handleMenuFocusin,onFocusout:this.handleMenuFocusout}),At(r.header,k=>k?g("div",{class:`${i}-tree-select-menu__header`,"data-header":!0},k):null),g(jn,{ref:"treeInstRef",blockLine:!0,allowCheckingNotLoaded:this.allowCheckingNotLoaded,showIrrelevantNodes:!1,animated:!1,pattern:this.pattern,getChildren:this.getChildren,filter:this.mergedFilter,data:x,cancelable:w,labelField:this.labelField,keyField:this.keyField,disabledField:this.disabledField,childrenField:this.childrenField,theme:e.peers.Tree,themeOverrides:e.peerOverrides.Tree,defaultExpandAll:this.defaultExpandAll,defaultExpandedKeys:this.defaultExpandedKeys,indent:this.indent,expandedKeys:this.mergedExpandedKeys,checkedKeys:this.treeCheckedKeys,selectedKeys:this.treeSelectedKeys,checkable:s,checkStrategy:this.checkStrategy,cascade:this.mergedCascade,leafOnly:this.leafOnly,multiple:this.multiple,renderLabel:this.renderLabel,renderPrefix:this.renderPrefix,renderSuffix:this.renderSuffix,renderSwitcherIcon:this.renderSwitcherIcon,nodeProps:this.nodeProps,watchProps:this.watchProps,virtualScroll:this.consistentMenuWidth&&this.virtualScroll,overrideDefaultNodeClickBehavior:this.overrideDefaultNodeClickBehavior,internalTreeSelect:!0,internalUnifySelectCheck:!0,internalScrollable:!0,internalScrollablePadding:this.menuPadding,internalFocusable:!1,internalCheckboxFocusable:!1,internalRenderEmpty:()=>g("div",{class:`${i}-tree-select-menu__empty`},wt(r.empty,()=>[g(St,{theme:e.peers.Empty,themeOverrides:e.peerOverrides.Empty})])),onLoad:this.onLoad,onUpdateCheckedKeys:this.handleUpdateCheckedKeys,onUpdateIndeterminateKeys:this.handleUpdateIndeterminateKeys,onUpdateExpandedKeys:this.doUpdateExpandedKeys}),At(r.action,k=>k?g("div",{class:`${i}-tree-select-menu__action`,"data-action":!0},k):null),g(wn,{onFocus:this.handleTabOut})),[[fn,this.handleMenuClickoutside,void 0,{capture:!0}]])}})})]}))}});export{nl as NTreeSelect,Vn as treeSelectProps};
